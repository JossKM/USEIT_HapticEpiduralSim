<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Volume Objects</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Overview</span></a></li>
      <li><a href="modules.html"><span>Documentation</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('chapter12-volume.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Volume Objects </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="section12-1"></a>
Introduction</h1>
<p>Volume rendering is essential to scientific and engineering applications that require visualization of three-dimensional data sets. Examples include visualization of data acquired by medical imaging devices or resulting from computational fluid dynamics simulations. Users of interactive volume rendering applications rely on the performance of modern graphics accelerators for efficient data exploration and feature discovery.</p>
<div class="image">
<img src="fig-voxels-model.png" alt="fig-voxels-model.png"/>
<div class="caption">
3D volume object composed from a stack of 2D images. See example 30-voxel-colormap.</div></div>
<h1><a class="anchor" id="section12-2"></a>
Voxel Data</h1>
<p>A voxel represents a value on a regular grid in three-dimensional space. Voxel is a portmanteau for "volume" and "pixel" where pixel is a combination of "picture" and "element". As with pixels in a bitmap, voxels themselves do not typically have their position (their coordinates) explicitly encoded along with their values. Instead, the position of a voxel is inferred based upon its position relative to other voxels (i.e., its position in the data structure that makes up a single volumetric image). In contrast to pixels and voxels, points and polygons are often explicitly represented by the coordinates of their vertices. A direct consequence of this difference is that polygons are able to efficiently represent simple 3D structures with lots of empty or homogeneously filled space, while voxels are good at representing regularly sampled spaces that are non-homogeneously filled.</p>
<p>Voxels are frequently used in the visualization and analysis of medical and scientific data. Some volumetric displays use voxels to describe their resolution. For example, a display might be able to show 512x512x512 voxels.</p>
<h1><a class="anchor" id="section12-3"></a>
Voxel Objects</h1>
<p>Volume objects are implemented in CHAI3D with a class called cVoxelObject, where the volume data is stored into memory as a 3D texture (cTexture3D). In the following code we illustrate how to setup such object and program the individual voxels.</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechai3d.html">chai3d</a>;</div><div class="line"></div><div class="line"><span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><span class="comment">// CREATE VOLUME MODEL</span></div><div class="line"><span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"></div><div class="line"><span class="comment">// create a volumetric model</span></div><div class="line"><a class="code" href="classchai3d_1_1c_voxel_object.html">cVoxelObject</a>* <span class="keywordtype">object</span> = <span class="keyword">new</span> <a class="code" href="classchai3d_1_1c_voxel_object.html">cVoxelObject</a>();</div><div class="line"></div><div class="line"><span class="comment">// add object to world</span></div><div class="line">world-&gt;addChild(<span class="keywordtype">object</span>);</div><div class="line">    </div><div class="line"><span class="comment">// set the dimensions by assigning the position of the min and max corners</span></div><div class="line"><span class="keywordtype">object</span>-&gt;m_minCorner.set(-0.5,-0.5,-0.5);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_maxCorner.set( 0.5, 0.5, 0.5);</div><div class="line"></div><div class="line"><span class="comment">// set the texture coordinate at each corner.</span></div><div class="line"><span class="keywordtype">object</span>-&gt;m_minTextureCoord.set(0.0, 0.0, 0.0);</div><div class="line"><span class="keywordtype">object</span>-&gt;m_maxTextureCoord.set(1.0, 1.0, 1.0);</div><div class="line"></div><div class="line"><span class="comment">// set general material color</span></div><div class="line"><span class="keywordtype">object</span>-&gt;m_material-&gt;setOrangeCoral();</div><div class="line"></div><div class="line"><span class="comment">// set stiffness property</span></div><div class="line"><span class="keywordtype">object</span>-&gt;setStiffness(0.2 * maxStiffness);</div><div class="line"></div><div class="line"><span class="comment">// show/hide boundary box</span></div><div class="line"><span class="keywordtype">object</span>-&gt;setShowBoundaryBox(<span class="keyword">false</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"><span class="comment">// CREATE VOXEL DATA</span></div><div class="line"><span class="comment">//--------------------------------------------------------------------------</span></div><div class="line"></div><div class="line"><span class="comment">// create multi image data structure</span></div><div class="line"><a class="code" href="namespacechai3d.html#a06085fb6973dcfe0c0c3af4ea3fd6c07">cMultiImagePtr</a> image = <a class="code" href="classchai3d_1_1c_multi_image.html#abf988375c9818898b86159d9f573442c">cMultiImage::create</a>();</div><div class="line"></div><div class="line"><span class="comment">// allocate 3D image data</span></div><div class="line">image-&gt;allocate(512, 512, 512, GL_RGBA);</div><div class="line"></div><div class="line"><span class="comment">// create texture</span></div><div class="line">texture = <a class="code" href="classchai3d_1_1c_texture3d.html#a9a0685df26afde94e58e37975bf74453">cTexture3d::create</a>();</div><div class="line"></div><div class="line"><span class="comment">// assign volumetric image to texture</span></div><div class="line">texture-&gt;setImage(image);</div><div class="line"></div><div class="line"><span class="comment">// assign texture to voxel object</span></div><div class="line"><span class="keywordtype">object</span>-&gt;setTexture(texture);</div><div class="line"></div><div class="line"><span class="comment">// set default rendering mode</span></div><div class="line"><span class="keywordtype">object</span>-&gt;setRenderingModeIsosurfaceMaterial();</div><div class="line"></div><div class="line"><span class="comment">// set quality of graphic rendering</span></div><div class="line"><span class="keywordtype">object</span>-&gt;setQuality(0.5);</div><div class="line"></div><div class="line"><span class="comment">// draw some 3D volumetric object</span></div><div class="line">buildVoxelShape(0.5, 0.2);</div></div><!-- fragment --><div class="image">
<img src="fig-voxels-sphere.png" alt="fig-voxels-sphere.png"/>
<div class="caption">
Editing voxels. See example 28-voxel-basic.</div></div>
<p> To edit the content of the voxel data, you can use the following method:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechai3d.html">chai3d</a>;</div><div class="line"></div><div class="line"><span class="comment">// assign a value to a voxel</span></div><div class="line">image-&gt;setVoxelColor(x, y, z, color);</div></div><!-- fragment --><p>After the data has been modified (one or more voxel), make sure to always flag the texture for update from CPU to GPU memory.</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechai3d.html">chai3d</a>;</div><div class="line"></div><div class="line"><span class="comment">// update voxel data from CPU to GPU memory</span></div><div class="line">texture-&gt;markForUpdate();</div></div><!-- fragment --><h1><a class="anchor" id="section12-4"></a>
File Support</h1>
<p>Volume models can also be constructed by loading into memory a stack of 2D images.</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechai3d.html">chai3d</a>;</div><div class="line"></div><div class="line"><span class="comment">// create multi image</span></div><div class="line"><a class="code" href="namespacechai3d.html#a06085fb6973dcfe0c0c3af4ea3fd6c07">cMultiImagePtr</a> image = <a class="code" href="classchai3d_1_1c_multi_image.html#abf988375c9818898b86159d9f573442c">cMultiImage::create</a>();</div><div class="line"></div><div class="line"><span class="comment">// load voxel data from images</span></div><div class="line"><span class="keywordtype">int</span> numImages = image-&gt;loadFromFiles(<span class="stringliteral">&quot;myModel0&quot;</span>), <span class="stringliteral">&quot;png&quot;</span>, 256);</div></div><!-- fragment --><div class="image">
<img src="fig-colormap.png" alt="fig-colormap.png"/>
<div class="caption">
Transfer functions.</div></div>
<p> If your volume images are in gray scale level (CT, MRI data), you can use a transfer function to colorize the data. The role of the transfer function is to emphasize features in the data by mapping values and other data measures to optical properties. The simplest and most widely used transfer functions are one dimensional, and they map the range of data values to color and opacity. Typically, these transfer functions are implemented with 1D texture lookup tables.</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechai3d.html">chai3d</a>;</div><div class="line"></div><div class="line"><span class="comment">// create colormap image</span></div><div class="line"><a class="code" href="namespacechai3d.html#a5e795a653d2394830c8983f19908e9d3">cImagePtr</a> colorMap = <a class="code" href="classchai3d_1_1c_image.html#abcec6c160c44b83ca5e6fb395f728fc0">cImage::create</a>();</div><div class="line"></div><div class="line"><span class="comment">// load colormap file</span></div><div class="line">colorMap-&gt;loadFromFile(<span class="stringliteral">&quot;myColorMap.png&quot;</span>);</div><div class="line"></div><div class="line"><span class="comment">// assign colormap to object</span></div><div class="line"><span class="keywordtype">object</span>-&gt;m_colorMap-&gt;setImage(colorMap);</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
