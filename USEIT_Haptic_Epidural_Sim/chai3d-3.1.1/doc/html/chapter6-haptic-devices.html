<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Haptic Devices</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Overview</span></a></li>
      <li><a href="modules.html"><span>Documentation</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('chapter6-haptic-devices.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Haptic Devices </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="section6-1"></a>
Introduction</h1>
<p>A haptic device is a bidirectional instrumented/actuated human-machine interface, employed by the human operator to actively interact with a computer simulated virtual environment. A haptic device can be in the form of a mouse, steering wheel, fingerpad, robotic handle, gripper, joystick, gloves, magnetically levitated wrist, or even motion platforms that move the entire user's body. It can be used to simulate an environment with mass, damping, friction, and stiffness properties, or it can mimic the mechanical behavior of a virtual tool interacting with its surrounding virtual environment.</p>
<p>CHAI3D provides a base class called <a class="el" href="classchai3d_1_1c_generic_haptic_device.html">cGenericHapticDevice</a> that implements a set of methods to communicate with most common 3D haptic devices. The position of the end-effector or handle of a haptic device can be read by using methods such as <a class="el" href="classchai3d_1_1c_generic_haptic_device.html#aedc284122c3d87f4bffe6f6f7f4d255c">getPosition()</a>, <a class="el" href="classchai3d_1_1c_generic_haptic_device.html#a4522885982750cf4f4dd9626fd63c230">getRotation()</a>, <a class="el" href="classchai3d_1_1c_generic_haptic_device.html#ae8a5684f90efc5e51381bd94d317dc6c">getGripperAngleDeg()</a>. Optional user switches or buttons can be read by calling <a class="el" href="classchai3d_1_1c_generic_haptic_device.html#a7ea76b043ae38e58a5e5e7da2ba0a264">getUserSwitch()</a>.</p>
<p>Forces and torques can be sent to the haptic device by calling methods such as <a class="el" href="classchai3d_1_1c_generic_haptic_device.html#a13b461852d9cba445f082b9a501872ac">setForce()</a>, <a class="el" href="classchai3d_1_1c_generic_haptic_device.html#aeaa8e4f6bed1ae3a169199e62bf457c2">setForceAndTorque()</a>,and <a class="el" href="classchai3d_1_1c_generic_haptic_device.html#a40924753fd216dc11dab45ba2a26c9b0">setForceAndTorqueAndGripperForce()</a>.</p>
<p>For each model of haptic device (e.g delta.x, omega.x falcon, phantom, etc.) CHAI3D implements a specific class (e.g <a class="el" href="classchai3d_1_1c_delta_device.html">cDeltaDevice</a>, <a class="el" href="classchai3d_1_1c_phantom_device.html">cPhantomDevice</a>) which inherits from <a class="el" href="classchai3d_1_1c_generic_haptic_device.html">cGenericHapticDevice</a> and implements each command by calling specific commands from the API that supports the device.</p>
<h1><a class="anchor" id="section6-2"></a>
General Conventions</h1>
<p>All quantities are expressed in IUS (metric) unit. The reference device coordinate system specifies that the x-axis is pointing towards the operator, the y-axis towards his or her right hand side, and the z-axis upward. Finally, the origin is always located at the center of the physical workspace of the device.</p>
<p>If the haptic device carries a wrist or stylus, the orientation of its handle is expressed by using a rotation matrix. The convention is illustrated in the following illustrations for a three, six, and seven degrees-of-freedom device.</p>
<div class="image">
<img src="fig-device-coordinates.png" alt="fig-device-coordinates.png"/>
<div class="caption">
Reference frame for a three, six, and seven degrees-of-freedom haptic device.</div></div>
<p> Example <code><b>02-multi-devices</b></code> is a simple application that displays a reference frame for each haptic device connected to the computer. Reference frames use colors instead of labels to name the different axis (respectively x, y and z). The color convention is: <b>red</b> for the x-axis, <b>green</b> for the y-axis, and <b>blue</b> for the z-axis.</p>
<div class="image">
<img src="fig-multi-device.png" alt="fig-multi-device.png"/>
<div class="caption">
CHAI3D example 02-multi-devices: Reference frame and cursor.</div></div>
<h1><a class="anchor" id="section6-3"></a>
Haptic Device Handler</h1>
<p>The haptic device handler (<a class="el" href="classchai3d_1_1c_haptic_device_handler.html">cHapticDeviceHandler</a>) is a class that searches for and lists all haptic devices connected to the computer.</p>
<p>In the following listing we illustrate a simple example that applies a force to a haptic device to bring its end-effector toward the center point of its workspace:</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacechai3d.html">chai3d</a>;</div><div class="line"></div><div class="line"><span class="comment">// create haptic device handler</span></div><div class="line"><a class="code" href="classchai3d_1_1c_haptic_device_handler.html">cHapticDeviceHandler</a>* handler;</div><div class="line">handler = <span class="keyword">new</span> <a class="code" href="classchai3d_1_1c_haptic_device_handler.html">cHapticDeviceHandler</a>();</div><div class="line"></div><div class="line"><span class="comment">// get handle to first available haptic device on the list</span></div><div class="line"><a class="code" href="classchai3d_1_1c_generic_haptic_device.html">cGenericHapticDevice</a>* hapticDevice;</div><div class="line">handler-&gt;<a class="code" href="classchai3d_1_1c_haptic_device_handler.html#aae5099b986c25b2f9afb5c2d2908e586">getDevice</a>(hapticDevice, 0);</div><div class="line"></div><div class="line"><span class="comment">// open connection to haptic device</span></div><div class="line">hapticDevice-&gt;<a class="code" href="classchai3d_1_1c_generic_haptic_device.html#ad17b036ef6401fe753bdf6664a435eca">open</a>();</div><div class="line"></div><div class="line"><span class="comment">// initialize simulation</span></div><div class="line"><span class="keywordtype">bool</span> simulationRunning = <span class="keyword">true</span>;</div><div class="line"><span class="keywordtype">double</span> Kp = 25;                 </div><div class="line"><a class="code" href="structchai3d_1_1c_vector3d.html">cVector3d</a> position(0,0,0);              </div><div class="line"></div><div class="line"><span class="comment">// haptics loop</span></div><div class="line"><span class="keywordflow">while</span> (simulationRunning)</div><div class="line">{</div><div class="line">        <span class="comment">// read position from haptic device</span></div><div class="line">        hapticDevice-&gt;<a class="code" href="classchai3d_1_1c_generic_haptic_device.html#aedc284122c3d87f4bffe6f6f7f4d255c">getPosition</a>(position);</div><div class="line">        </div><div class="line">        <span class="comment">// compute force</span></div><div class="line">        <a class="code" href="structchai3d_1_1c_vector3d.html">cVector3d</a> force = -Kp * position;</div><div class="line"></div><div class="line">        <span class="comment">// send force to haptic device</span></div><div class="line">        hapticDevice-&gt;<a class="code" href="classchai3d_1_1c_generic_haptic_device.html#a13b461852d9cba445f082b9a501872ac">setForce</a>(force);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// close connection to haptic device</span></div><div class="line">hapticDevice-&gt;<a class="code" href="classchai3d_1_1c_generic_haptic_device.html#a26741c1987af82d52c2d66505ecc75ce">close</a>();</div></div><!-- fragment --><h1><a class="anchor" id="section6-4"></a>
Custom Haptic Devices</h1>
<p><a class="el" href="classchai3d_1_1c_my_custom_device.html">cMyCustomDevice</a> provides a basic template which allows you to very easily interface CHAI3D to your own custom haptic device. Simply follow the 12 commented step in file <a class="el" href="_c_my_custom_device_8cpp.html">CMyCustomDevice.cpp</a> and complete the code accordingly. Depending of the numbers of degrees of freedom on your device, not all methods may need to be implemented. For instance, if your device does not provide any rotational degrees of freedom, simply ignore the <a class="el" href="classchai3d_1_1c_generic_haptic_device.html#a4522885982750cf4f4dd9626fd63c230">getRotation()</a> method. Default values will be returned correctly if these are not implemented on your device. In the case of rotations for instance, the identity matrix is returned.</p>
<p>You may also rename this class in which case you will also want to customize the haptics handler to automatically detect your device. Please consult method <a class="el" href="classchai3d_1_1c_haptic_device_handler.html#a35a65759788b824903bdb99f835bb6d0">update()</a> of the <a class="el" href="classchai3d_1_1c_haptic_device_handler.html">cHapticDeviceHandler</a> class which is located in file <a class="el" href="_c_haptic_device_handler_8cpp.html">CHapticDeviceHandler.cpp</a>. Simply see how the haptic device handler already looks for device of type <a class="el" href="classchai3d_1_1c_my_custom_device.html">cMyCustomDevice</a>.</p>
<p>If you are encountering any problems with your implementation, check for instance file <a class="el" href="_c_delta_devices_8cpp.html">CDeltaDevices.cpp</a> which implement supports for the Force Dimension and Novint haptic devices. In order to verify the implementation use the <code><b>01-mydevice</b></code> example to get started. Example <code><b>11-effects</b></code> is a great demo to verify how basic haptic effects may behave with you haptic devices. If you do encounter vibrations or instabilities, try reducing the maximum stiffness supported by your device (see STEP1 in file <a class="el" href="_c_my_custom_device_8cpp.html">CMyCustomDevice.cpp</a>).</p>
<p>Make sure that your device is also communicating fast enough with your computer. Ideally the communication period should take less than 1ms in order to reach a desired update rate of at least 1000Hz. Problems can typically occur when using a slow serial port (RS232) for instance. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
